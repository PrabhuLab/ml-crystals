% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/process_cif_files.R
\name{export_analysis_to_csv}
\alias{export_analysis_to_csv}
\title{Export Analysis Results to a Directory of CSVs}
\usage{
export_analysis_to_csv(analysis_results, output_dir, overwrite = FALSE)
}
\arguments{
\item{analysis_results}{A \code{data.table} object, typically the output from
\code{analyze_cif_files}.}

\item{output_dir}{A character string specifying the path to the main output
directory where the folders and files will be created.}

\item{overwrite}{A logical value. If \code{TRUE}, any existing directory at
\code{output_dir} will be removed and recreated. If \code{FALSE} (the default), the
function will stop with an error if the directory already exists.}
}
\value{
Invisibly returns the path to the \code{output_dir}.
}
\description{
Takes the output \code{data.table} from \code{analyze_cif_files} or
\code{analyze_single_cif} and exports its contents into a structured directory
of CSV files. A 'meta' folder is created for top-level data, and
separate folders are created for each nested table (e.g., atomic_coordinates,
bond_angles).
}
\details{
The function operates as follows:
\enumerate{
\item It creates the main \code{output_dir}. If the directory already exists,
the function will stop unless \code{overwrite = TRUE}.
\item It identifies which columns in the input \code{analysis_results} are standard
data (metadata) and which are list-columns containing nested \code{data.table}s.
\item The metadata is saved as a single \code{meta_summary.csv} file inside a \code{meta} sub-directory.
\item For each list-column (e.g., \code{unit_cell_metrics}), it creates a sub-directory
with that name (e.g., \verb{output_dir/unit_cell_metrics/}).
\item Inside each sub-directory, it iterates through every row of the original
\code{analysis_results} table. For each row, it saves the corresponding nested
\code{data.table} as a CSV file. The CSV is named after the CIF file it
originated from (e.g., \code{ICSD422.csv}).
}

This structure makes it easy to access all data of a specific type (e.g., all
bond angle tables) or all data related to a single original CIF file.
}
\examples{
# This is a full workflow example.

# 1. Define path to an example CIF file
cif_file <- system.file("extdata", "ICSD422.cif", package = "crysmal")
if (file.exists(cif_file)) {
  # 2. Run the analysis
  analysis_results <- analyze_cif_files(cif_file)

  # 3. Define a temporary output directory for this example
  export_path <- file.path(tempdir(), "crysmal_export")

  # 4. Export the results, overwriting if the directory exists
  export_analysis_to_csv(analysis_results, export_path, overwrite = TRUE)

  # 5. List the created files and folders to verify
  cat("Exported directory structure:\n")
  print(list.files(export_path, recursive = TRUE))

  # 6. Clean up the temporary directory
  unlink(export_path, recursive = TRUE)
}
}
\seealso{
Other post-processing: 
\code{\link{calculate_weighted_average_network_distance}()},
\code{\link{filter_ghost_distances}()}
}
\concept{post-processing}
