% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_properties.R
\name{calculate_angles}
\alias{calculate_angles}
\title{Calculate Bond Angles}
\usage{
calculate_angles(
  bonded_pairs,
  atomic_coordinates,
  expanded_coords,
  unit_cell_metrics
)
}
\arguments{
\item{bonded_pairs}{A data.table of bonded pairs, with columns Atom1 (central) and Atom2 (neighbor).}

\item{atomic_coordinates}{A data.table of the original (asymmetric unit) atomic coordinates.
These are used as the central atoms for angle calculations.}

\item{expanded_coords}{A data.table of expanded coordinates (including those in neighboring cells).
This table is used to look up the positions of all atoms involved in angles.}

\item{unit_cell_metrics}{A data.table or list with unit cell parameters.}
}
\value{
A data.table with CentralAtom, Neighbor1, Neighbor2, and Angle (in degrees).
        Returns NULL if inputs are invalid or no angles can be formed.
}
\description{
Calculates bond angles (Neighbor1 - CentralAtom - Neighbor2) based on bonded pairs
and atomic coordinates, using the unit cell metric tensor.
}
\examples{
# ucm <- data.table("_cell_length_a"=10, "_cell_length_b"=10, "_cell_length_c"=10,
#                   "_cell_angle_alpha"=90, "_cell_angle_beta"=90, "_cell_angle_gamma"=90)
# ac <- data.table(Label=c("C1", "H1", "H2"), x_a=c(0,0,0.1), y_b=c(0,0.1,0), z_c=c(0,0.05,0.05))
# ec <- ac # Simplified example, expanded_coords should contain all relevant atom positions
# bonds <- data.table(Atom1=c("C1","C1"), Atom2=c("H1","H2"))
# calculate_angles(bonds, ac, ec, ucm)
}
